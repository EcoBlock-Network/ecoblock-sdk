import 'package:flutter/material.dart';

/// Very small runtime translation helper used as a stop-gap before
/// moving to Flutter's recommended gen_l10n / intl pipeline.
///
/// Usage: tr(context, 'key', {'xp': '100'})
String tr(BuildContext context, String key, [Map<String, String>? params]) {
  final lang = Localizations.localeOf(context).languageCode;
  final map = _localizedValues[lang] ?? _localizedValues['en']!;
  var value = map[key] ?? key;
  if (params != null) {
    params.forEach((k, v) {
      value = value.replaceAll('{$k}', v);
    });
  }
  return value;
}

const Map<String, Map<String, String>> _localizedValues = {
  'en': {
    'xp_added': '+{xp} XP added to your profile!',
    'could_not_complete_quest': 'Could not complete quest. Please try again.',
    'unique_quests_all': 'All unique quests',
    'see_more': 'See more',
  'loading_error': 'Loading error',
  // quest card
  'quest_completed_title': 'Quest completed!',
  'quest_completed_content': 'You have completed "{title}".',
  'ok': 'OK',
  'quest_progress': '"{title}" — {progress}/{goal}',
  // settings
  'settings.title': 'Settings',
  'settings.display': 'Display',
  'settings.theme': 'Theme',
  'theme.light': 'Light',
  'theme.dark': 'Dark',
  'theme.system': 'System',
  'settings.language': 'Language',
  'lang.fr': 'Français',
  'lang.en': 'English',
  'lang.es': 'Español',
  'settings.notifications': 'Push notifications',
  'enabled': 'Enabled',
  'disabled': 'Disabled',
  'settings.data_saver': 'Data saver',
  'settings.erase_local_data': 'Erase local data',
  'settings.erase_local_data_sub': 'Removes all locally stored data',
  'settings.reset_settings': 'Reset settings',
  'confirm.cancel': 'Cancel',
  'confirm.erase': 'Erase',
  'confirm.reset': 'Reset',
  'settings.about.version': 'App version',
  'settings.legal': 'Legal / Terms of use',
  'settings.legal_action': 'View terms',
  'settings.privacy': 'Privacy',
  'settings.about': 'About',
  // profile
  'profile.stats': 'Statistics',
  'profile.badges': 'Badges',
  'profile.loots': 'Loots',
  'no_loot': 'No loot unlocked',
  'profile.activity': 'Activity',
  'profile.block_history_title': 'Block history',
  'profile.block_history_sub': 'See your contributions to the mesh network',
  'profile.error_stats': 'Stats error',
  'profile.error_badges': 'Badges error',
  'profile.error_loots': 'Loots error',
  'profile.error': 'Profile error',
  // daily quests
  'no_quest': 'No quest',
  'until_refresh': 'until refresh',
  // onboarding
  'onboarding.welcome': 'Welcome to EcoBlock',
  'onboarding.hint': "Let's get started! Complete your profile and discover your first quests.",
  'onboarding.start': 'Start my adventure',
  // additional onboarding keys
  'onboarding.join.title': 'Welcome to EcoBlock',
  'onboarding.join.subtitle': 'Create your local node and join the community to contribute environmental data.',
  'onboarding.join.cta': 'Create my node',
  'onboarding.join.how_it_works': 'How does it work?',
  'onboarding.step.create_node': 'Create your secure local node',
  'onboarding.step.find_neighbors': 'Discover and pair neighbors',
  'onboarding.step.participate': 'Help propagate blocks and collect data',
  'onboarding.privacy': 'EcoBlock respects your privacy: keys are generated and stored locally on your device.',
  'xp.short': '+{xp} XP',
  // community
  'community.title': 'Community',
  'community.loading_challenges': 'Failed to load challenges',
  'community.leaderboard.title': 'Community leaderboard',
  'community.rank': 'Your rank: {rank} ({pseudo})',
  'community.not_in_top_10': 'You are not in the top 10',
  'community.error_leaderboard': 'Leaderboard error',
  'community.error_tree': 'Tree error',
  'community.error_mesh_map': 'Mesh map error',
  'community.error_rewards': 'Rewards error',
  'community.error_history': 'History error',
  // messaging
  'messaging.title': 'Messaging',
  // help / misc
  'help_title': 'FAQ, support, about',
  'mesh_simulator_title': 'Mesh BLE Simulator',
  'node_detail_info': 'Node detailed info',
  'my_blocks': 'My Blocks',
  'no_blocks': 'No blocks available',
  'error_loading_blocks': 'Error loading blocks',
  'my_quests': 'My Quests',
  'no_quests_available': 'No quests available',
  'error_loading_quests': 'Error loading quests',
  // additional keys used by recent edits
  'reward.threshold': 'Tier: {threshold}',
  'leaderboard.score': 'Score: {score}',
  'daily.progress': '{progress}/{goal}',
  'community.upcoming_title': 'History & upcoming challenges',
  'profile.block_id': 'ID: {id}...',
  'profile.received': 'Received {time}',
  'profile.status': 'Status: {status}',
  'level.display': 'Level {level}',
  'xp.progress': '{current} / {needed} XP',
  'daily_quests.title': 'Daily Quests',
  'unique_quests.title': 'Unique Quests',
  'quest.progress': 'Progression: {progress}/{goal}',
  
  'quest.ends': 'Ends: {date}',
  'quests.title': 'Quests',
  'quests.personal_title': 'Personal Quests',
  'quests.community_title': 'Community Quests',
  'error.loading': 'Loading error',
  'leaderboard.rank': '{rank}',
  'profile.type_value': '{type} : {value}',
  // dashboard
  'dashboard.title': 'My EcoNode',
  'dashboard.subtitle': 'Welcome to the EcoBlock mesh',
  // messaging extras
  'messaging.sample.launch_title': 'EcoBlock — Launch',
  'messaging.sample.planting': 'Planting for tomorrow',
  'messaging.sample.stability': 'Network stability',
  // profile extras
  'profile.my_tangle': 'My Tangle',
  'profile.tangle_sub': 'Network visualization and collected data',
  'profile.recommended_actions': 'Recommended actions',
  'profile.sync_nodes': 'Synchronize nodes and fetch latest data',
  'profile.synchronize': 'Synchronize',
  'profile.connected_nodes': 'Connected nodes',
  'profile.export_data': 'Export data',
  'profile.settings': 'Settings',
  },
  'fr': {
    'xp_added': '+{xp} XP ajouté·e à votre profil !',
    'could_not_complete_quest': 'Impossible de compléter la quête. Réessayez.',
    'unique_quests_all': 'Toutes les quêtes uniques',
    'see_more': 'Voir plus',
  'loading_error': 'Erreur de chargement',
  // quest card
  'quest_completed_title': 'Quête complétée !',
  'quest_completed_content': 'Vous avez complété "{title}".',
  'ok': 'OK',
  'quest_progress': '"{title}" — {progress}/{goal}',
  // settings
  'settings.title': 'Réglages',
  'settings.display': 'Affichage',
  'settings.theme': 'Thème',
  'theme.light': 'Clair',
  'theme.dark': 'Sombre',
  'theme.system': 'Système',
  'settings.language': 'Langue',
  'lang.fr': 'Français',
  'lang.en': 'Anglais',
  'lang.es': 'Espagnol',
  'settings.notifications': 'Notifications push',
  'enabled': 'Activées',
  'disabled': 'Désactivées',
  'settings.data_saver': 'Économie de données',
  'settings.erase_local_data': 'Effacer les données locales',
  'settings.erase_local_data_sub': 'Supprime toutes les données stockées sur l’appareil',
  'settings.reset_settings': 'Réinitialiser les réglages',
  'confirm.cancel': 'Annuler',
  'confirm.erase': 'Effacer',
  'confirm.reset': 'Réinitialiser',
  'settings.about.version': 'Version de l’application',
  'settings.legal': 'Mentions légales / CGU',
  'settings.legal_action': 'Consulter les conditions d’utilisation',
  // profile
  'profile.stats': 'Statistiques',
  'profile.badges': 'Badges',
  'profile.loots': 'Loots',
  'no_loot': 'Aucun loot débloqué',
  'profile.activity': 'Activité',
  'profile.block_history_title': 'Historique des blocs',
  'profile.block_history_sub': 'Voir vos contributions au réseau mesh',
  'profile.error_stats': 'Erreur stats',
  'profile.error_badges': 'Erreur badges',
  'profile.error_loots': 'Erreur loots',
  'profile.error': 'Erreur profil',
  // daily quests
  'no_quest': 'Aucune quête',
  'until_refresh': 'jusqu\'au rafraîchissement',
  // onboarding
  'onboarding.welcome': 'Bienvenue sur EcoBlock',
  'onboarding.hint': 'Comblez votre profil et découvrez vos premières quêtes.',
  'onboarding.start': 'Commencer l\'aventure',
  // additional onboarding keys
  'onboarding.join.title': 'Bienvenue sur EcoBlock',
  'onboarding.join.subtitle': 'Crée ton nœud local et rejoins la communauté pour participer à la collecte collaborative de données environnementales.',
  'onboarding.join.cta': 'Créer mon nœud',
  'onboarding.join.how_it_works': 'Comment ça marche ?',
  'onboarding.step.create_node': 'Crée ton nœud local sécurisé',
  'onboarding.step.find_neighbors': 'Découvre et associe des voisins',
  'onboarding.step.participate': 'Participe à la propagation des blocs et à la collecte de données',
  'onboarding.privacy': 'EcoBlock respecte ta vie privée : toutes les clés sont générées et stockées localement sur ton appareil.',
  'xp.short': '+{xp} XP',
  // community
  'community.title': 'Communauté',
  'community.loading_challenges': 'Impossible de charger les défis',
  'community.leaderboard.title': 'Classement communautaire',
  'community.rank': 'Votre rang : {rank} ({pseudo})',
  'community.not_in_top_10': 'Vous n\'êtes pas dans le top 10',
  'community.error_leaderboard': 'Erreur leaderboard',
  'community.error_tree': 'Erreur arbre',
  'community.error_mesh_map': 'Erreur mesh map',
  'community.error_rewards': 'Erreur récompenses',
  'community.error_history': 'Erreur historique',
  // messaging
  'messaging.title': 'Messagerie',
  // profile extras
  'profile.my_tangle': 'Mon Tangle',
  'profile.tangle_sub': 'Visualisation du réseau et données collectées',
  'profile.recommended_actions': 'Actions recommandées',
  'profile.sync_nodes': 'Synchroniser les nœuds et récupérer les dernières données',
  'profile.synchronize': 'Synchroniser',
  'profile.connected_nodes': 'Nœuds connectés',
  'profile.export_data': 'Exporter les données',
  'profile.settings': 'Paramètres',
  // help / misc
  'help_title': 'FAQ, support, à propos',
  'mesh_simulator_title': 'Simulateur Mesh BLE',
  'node_detail_info': 'Infos détaillées sur le nœud',
  'my_blocks': 'Mes Blocs',
  'no_blocks': 'Aucun bloc disponible',
  'error_loading_blocks': 'Erreur chargement blocs',
  'my_quests': 'Mes Quêtes',
  'no_quests_available': 'Aucune quête disponible',
  'error_loading_quests': 'Erreur de chargement des quêtes',
  // additional keys used by recent edits
  'reward.threshold': 'Palier : {threshold}',
  'leaderboard.score': 'Score : {score}',
  'daily.progress': '{progress}/{goal}',
  'community.upcoming_title': 'Historique & défis à venir',
  'profile.block_id': 'ID : {id}...',
  'profile.received': 'Reçu {time}',
  'profile.status': 'Statut : {status}',
  'level.display': 'Niveau {level}',
  'xp.progress': '{current} / {needed} XP',
  'daily_quests.title': 'Quêtes quotidiennes',
  'unique_quests.title': 'Quêtes uniques',
  'quest.progress': 'Progression: {progress}/{goal}',
  'quest.ends': 'Fin : {date}',
  'quests.title': 'Quêtes',
  'quests.personal_title': 'Quêtes personnelles',
  'quests.community_title': 'Quêtes communautaires',
  'error.loading': 'Erreur de chargement',
  'leaderboard.rank': '{rank}',
  'profile.type_value': '{type} : {value}',
  // dashboard
  'dashboard.title': 'Mon EcoNode',
  'dashboard.subtitle': 'Bienvenue sur le mesh EcoBlock',
  // messaging extras
  'messaging.sample.launch_title': 'EcoBlock — Lancement',
  'messaging.sample.planting': 'Planter pour demain',
  'messaging.sample.stability': 'Stabilité réseau',
  }
};
